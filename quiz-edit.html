<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–†–µ–¥–∞–∫—Ç–æ—Ä ‚Äî –ü–∞—Ä—è—â–∏–π –∫–≤–∏–∑ (–ö–ì–ë)</title>
<link id="gf" rel="stylesheet" href="">
<style>
    :root{ --ui-acc:#ffd700; --card:#151515; --ink:#eee; --muted:#b7b7b7; --stroke:#2a2a2a; --gap:16px; }
    *{box-sizing:border-box} html,body{height:100%}
    body{ margin:0; background:#0d0d0d; color:var(--ink); font-family:Rubik,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; display:flex; flex-direction:column;}
    header{ display:flex; align-items:center; gap:12px; padding:16px 20px; border-bottom:1px solid var(--stroke); position:sticky; top:0; z-index:10; background:#0d0d0d;}
    header img{height:42px} header h1{margin:0; font-size:20px; font-weight:800; color:var(--ui-acc)}
    main{ display:grid; grid-template-columns: 430px 1fr; gap:22px; padding:20px; max-width:1500px; width:100%; margin:0 auto}
    .card{ background:var(--card); border:1px solid var(--stroke); border-radius:14px; padding:18px; box-shadow:0 0 28px rgba(255,215,0,.06);}
    .card h2{ margin:0 0 14px; font-size:18px; color:var(--ui-acc); display:flex; align-items:center; gap:10px}
    label{ display:block; margin:12px 0 8px; font-size:15px; color:#fff; font-weight:600}
    input[type="text"], input[type="number"], input[type="url"], input[type="color"], textarea, select{
      width:100%; background:#101010; color:#fff; border:1px solid #3a3a3a; border-radius:10px; padding:12px 14px; font-size:16px;
      outline:none; transition:border-color .15s ease, box-shadow .15s ease;
    }
    textarea{min-height:110px; resize:vertical}
    input:focus, textarea:focus, select:focus{border-color:#4b4b4b; box-shadow:0 0 0 3px rgba(255,215,0,.16)}
    .row{display:grid; grid-template-columns:1fr 1fr; gap:var(--gap)}
    .toolbar{display:flex; gap:12px; flex-wrap:wrap}
    .levels .level{background:#111; border:1px solid #2a2a2a; border-radius:12px; padding:16px}
    .level h3{margin:0 0 10px; font-size:16px; color:#fff; display:flex; align-items:center; justify-content:space-between}
    .right{display:flex; gap:10px; align-items:center}
    .hint{color:var(--muted); font-size:13px; margin-top:8px}
    .pill{display:inline-block; padding:8px 12px; border:1px dashed #444; border-radius:999px; color:#bbb; font-size:13px}
    button{ background:linear-gradient(90deg,#ffbf00,#ffd700); color:#000; border:none; border-radius:12px; font-weight:800; padding:14px 18px; cursor:pointer; transition:transform .15s ease, box-shadow .15s ease; font-size:16px;}
    button:hover{transform:translateY(-1px); box-shadow:0 8px 26px rgba(255,215,0,.28)}
    .btn-ghost{background:transparent; color:#fff; border:1px solid #444}
    .btn-danger{background:#a80000; color:#fff}
    .preview-controls{display:grid; grid-template-columns:1fr auto; gap:12px}
    .preview-stage{ margin-top:12px; background:#0a0a0a; border:1px dashed #333; border-radius:12px; min-height:320px; display:flex; align-items:center; justify-content:center; padding:24px}
    .preview-item{ position:relative; display:inline-flex; align-items:center; justify-content:center; padding:18px 22px; min-width:160px; min-height:70px; transition:all .2s ease; background:#151515; border:1px solid rgba(255,255,255,.12); border-radius:16px; box-shadow:0 10px 30px rgba(0,0,0,.5)}
    .preview-item img{max-width:200px; max-height:140px; display:block}
    .preview-item span{font-weight:800; font-size:24px}
    footer{padding:14px 20px; color:#888; border-top:1px solid var(--stroke); display:flex; align-items:center; justify-content:center}
    footer a{color:var(--ui-acc); text-decoration:none}
  </style>
</head>
<body>
  <header>
    <img src="https://con.xl.ru/fnfLZuvpAUiDaqDs8d1-2g/images/kcJYv7OsYUSGt5AfGq5jIw.png" alt="–ö–ì–ë" />
    <h1>–†–µ–¥–∞–∫—Ç–æ—Ä –∏–≥—Ä—ã ¬´–ü–∞—Ä—è—â–∏–π –∫–≤–∏–∑¬ª ‚Äî –ö–ì–ë</h1>
  </header>

  <main>
    <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ -->
    <div class="card" style="margin-top:16px">
  <h2>üõ† –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–≤–∏–∑–∞</h2>
  <div class="row">
    <div>
      <label>–í–∞—Ä–∏–∞–Ω—Ç–æ–≤ –Ω–∞ –≤–æ–ø—Ä–æ—Å (2‚Äì10)</label>
      <input type="number" id="answersPerQuestion" value="4" min="2" max="10">
    </div>
    <div>
      <label>–ò–Ω—Ç–µ—Ä–≤–∞–ª —Å–ø–∞–≤–Ω–∞ (–º—Å)</label>
      <input type="number" id="spawnInterval" value="900" min="200" step="50">
    </div>
  </div>
  <div class="row">
    <div>
      <label>–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—è–≤–ª–µ–Ω–∏—è</label>
      <select id="direction">
        <option value="vertical" selected>–°–≤–µ—Ä—Ö—É –≤–Ω–∏–∑</option>
        <option value="horizontal">–°–ª–µ–≤–∞ –Ω–∞–ø—Ä–∞–≤–æ</option>
      </select>
    </div>
  </div>
</div>

    <section class="card">
      <h2>‚öôÔ∏è –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
      <div class="row">
        <div>
          <label>–Ø–∑—ã–∫ / —Ä–µ–∂–∏–º</label>
          <select id="language">
            <option value="ru" selected>–†—É—Å—Å–∫–∏–π</option>
            <option value="en">English (Latin)</option>
            <option value="fr">Fran√ßais</option>
            <option value="es">Espa√±ol</option>
            <option value="de">Deutsch</option>
            <option value="zh">‰∏≠Êñá</option>
            <option value="ja">Êó•Êú¨Ë™û</option>
            <option value="math">–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ (LaTeX)</option>
          </select>
        </div>
        <div>
         <label>–®—Ä–∏—Ñ—Ç</label>
<select id="font">
  <option selected>PT Sans</option>
  <option>Rubik</option>
  <option>Lobster</option>
  <option>Marck Script</option>
  <option>Cormorant</option>
  <option>Montserrat</option>
  <option>Open Sans</option>
  <option>Noto Sans</option>
</select>
        </div>
      </div>

      <div class="row">
        <div>
          <label>–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞ (px)</label>
          <input type="number" id="fontSize" value="24" min="10" max="100">
        </div>
        <div>
          <label>–¶–≤–µ—Ç —à—Ä–∏—Ñ—Ç–∞</label>
          <input type="color" id="textColor" value="#ffffff">
        </div>
      </div>

      <div class="row">
        <div>
          <label>–°–∫–æ—Ä–æ—Å—Ç—å –ø–∞–¥–µ–Ω–∏—è (1‚Äì10)</label>
          <input type="number" id="speed" value="5" min="1" max="10">
        </div>
        <div>
          <label>–ö–∞—Å—Ç–æ–º–Ω—ã–π –∫—É—Ä—Å–æ—Ä (URL, –æ–ø—Ü.)</label>
          <input type="url" id="cursorUrl" placeholder="https://.../cursor.png">
        </div>
      </div>

      <!-- üé® –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ -->
      <div class="card" style="margin-top:16px">
        <h2>üé® –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ </h2>

        <div class="row">
          <div>
            <label>–§–∏–≥—É—Ä–∞</label>
            <select id="shape">
              <option selected>–ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫</option>
              <option>–°–∫—Ä—É–≥–ª—ë–Ω–Ω—ã–π</option>
              <option>–ö—Ä—É–≥</option>
            </select>
          </div>
          <div>
            <label>–§–æ–Ω ‚Äî —Ü–≤–µ—Ç</label>
            <input type="color" id="bgColor" value="#151515">
          </div>
        </div>

        <label>–§–æ–Ω ‚Äî –∫–∞—Ä—Ç–∏–Ω–∫–∞ (URL, –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
        <input type="url" id="bgImage" placeholder="https://.../bubble.png">

        <div class="row">
          <div>
            <label>–†–∞–º–∫–∞ (—Ü–≤–µ—Ç)</label>
            <input type="color" id="borderColor" value="#ffffff">
          </div>
          <div>
            <label>–†–∞–º–∫–∞ (—Ç–æ–ª—â–∏–Ω–∞, px)</label>
            <input type="number" id="borderWidth" value="1" min="0" max="20">
          </div>
        </div>

        <div class="row">
          <div>
            <label><input type="checkbox" id="borderOn" checked> –†–∞–º–∫–∞ –≤–∫–ª—é—á–µ–Ω–∞?</label>
          </div>
          <div>
            <label><input type="checkbox" id="shadowOn" checked> –¢–µ–Ω—å</label>
          </div>
        </div>

        <div class="row">
          <div>
            <label><input type="checkbox" id="glowOn"> –ü–æ–¥—Å–≤–µ—Ç–∫–∞</label>
          </div>
          <div>
            <label>–¶–≤–µ—Ç –ø–æ–¥—Å–≤–µ—Ç–∫–∏</label>
            <input type="color" id="glowColor" value="#00ffff">
          </div>
        </div>

        <div class="row">
          <div>
            <label>–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å —Ñ–æ–Ω–∞/–∫–∞—Ä—Ç–∏–Ω–∫–∏ (0‚Äì1)</label>
            <input type="number" id="alpha" value="1" min="0" max="1" step="0.05">
          </div>
          <div>
            <label><input type="checkbox" id="effect3d"> 3D —ç—Ñ—Ñ–µ–∫—Ç</label>
          </div>
        </div>

        <div class="row">
          <div>
            <label>–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ—Ç—Å—Ç—É–ø—ã (px)</label>
            <input type="number" id="padding" value="22" min="0" max="80">
          </div>
        </div>

      </div>
    </section>

  <div class="card" style="margin-top:16px">
        <h2>üíª –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</h2>
        <div class="preview-controls">
          <input type="text" id="previewValue" placeholder="–¢–µ–∫—Å—Ç –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏–ª–∏ URL –∫–∞—Ä—Ç–∏–Ω–∫–∏..." value="Preview">
          <div>
            <button type="button" class="btn-ghost" id="btnText">–¢–µ–∫—Å—Ç</button>
            <button type="button" class="btn-ghost" id="btnImage">–ö–∞—Ä—Ç–∏–Ω–∫–∞</button>
          </div>
        </div>
        <div class="preview-stage">
          <div id="previewItem" class="preview-item" data-mode="text">
            <span id="previewText">Preview</span>
          </div>
        </div>
        <div class="hint">–ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω URL ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞—Ä—Ç–∏–Ω–∫–∞/–≥–∏—Ñ–∫–∞. –®—Ä–∏—Ñ—Ç/—Ü–≤–µ—Ç/—Ä–∞–∑–º–µ—Ä –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ —Ç–µ–∫—Å—Ç—É –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞.</div>
      </div>

    <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ -->
    <section class="card">
      <h2>‚ùì –í–æ–ø—Ä–æ—Å—ã</h2>

    <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ -->
    <section class="card">
      <h2>‚ùì –í–æ–ø—Ä–æ—Å—ã</h2>
      <div id="levels" class="levels"></div>
      <div class="toolbar">
        <button id="addQ">‚ûï –î–æ–±–∞–≤–∏—Ç—å –≤–æ–ø—Ä–æ—Å</button>
        <span class="pill">–ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ –≤–æ–ø—Ä–æ—Å–æ–≤</span>
      </div>

      <h2 style="margin-top:8px">üöÄ –ü—É–±–ª–∏–∫–∞—Ü–∏—è</h2>
      <div class="row">
        <button id="saveBtn">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –ø–æ–ª—É—á–∏—Ç—å iframe</button>
        <button id="testBtn" class="btn-ghost">üîç –í–∞–ª–∏–¥–∞—Ü–∏—è JSON</button>
      </div>

      <div class="result" style="margin-top:10px; display:grid; grid-template-columns:1fr auto; gap:12px; align-items:start">
        <textarea id="iframeOut" readonly placeholder="–ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è iframe –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏" style="height:120px; font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace"></textarea>
        <button id="copyBtn" class="btn-ghost">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
      </div>
      <div class="hint">–ó–∞–≥—Ä—É–∑–∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π JSON –≤ –ø–∞–ø–∫—É <code>/data</code> —Å–≤–æ–µ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è ‚Üí Commit.</div>
    </section>
  </main>

  <footer>¬© 2025 <a href="https://kgbgamecorp.ru" target="_blank" rel="noopener">–ö–æ—Ä–ø–æ—Ä–∞—Ü–∏—è –ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ë—É–¥—É—â–µ–≥–æ</a></footer>

  <script>
    const $=s=>document.querySelector(s); const $$=s=>document.querySelectorAll(s);

    // –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä
    // —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è ‚Üí –∏–º—è —Å–µ–º—å–∏ –≤ Google Fonts
const GF_FAMILY = {
  'PT Sans': 'PT+Sans',
  'Rubik': 'Rubik',
  'Lobster': 'Lobster',
  'Marck Script': 'Marck+Script',
  'Cormorant': 'Cormorant',
  'Montserrat': 'Montserrat',
  'Open Sans': 'Open+Sans',
  'Noto Sans': 'Noto+Sans'
};

function loadGF(name){
  const fam = GF_FAMILY[name];
  const link = document.getElementById('gf');
  if(link){
    link.href = fam
      ? `https://fonts.googleapis.com/css2?family=${fam}:wght@400;700&display=swap`
      : '';
  }
}

function applyFontToPreview(){
  const font = $('#font').value;       // —Ç–µ–ø–µ—Ä—å —ç—Ç–æ <select>
  loadGF(font);                        // –¥–æ–≥—Ä—É–∂–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —à—Ä–∏—Ñ—Ç
  const text = $('#previewText');
  text.style.fontFamily = `${font}, system-ui, sans-serif`;
  text.style.fontSize   = (parseInt($('#fontSize').value,10)||24)+'px';
  text.style.color      = $('#textColor').value;
}

    function hexToRGBA(hex, a){
  try{
    const m = hex.replace('#','');
    const r = parseInt(m.substring(0,2),16);
    const g = parseInt(m.substring(2,4),16);
    const b = parseInt(m.substring(4,6),16);
    return `rgba(${r},${g},${b},${a})`;
  }catch(_){ return `rgba(0,0,0,${a||1})`; }
}

function updatePreview(){
  const item=$('#previewItem'); const text=$('#previewText'); const val=$('#previewValue').value.trim();
  const asImage = item.dataset.mode==='image' || /^https?:\/\//i.test(val);

  applyFontToPreview();

  // —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ: —Ç–µ–∫—Å—Ç/–∫–∞—Ä—Ç–∏–Ω–∫–∞
  if(asImage){
    text.style.display='none';
    if(!item.querySelector('img')){const img=document.createElement('img'); item.appendChild(img);}
    const img=item.querySelector('img'); img.src = val || 'https://via.placeholder.com/200x140?text=Image';
  }else{
    const img=item.querySelector('img'); if(img) img.remove();
    text.style.display='block'; text.textContent = val || 'Preview';
  }

  // —Å—Ç–∏–ª–∏ –±–ª–æ–∫–∞
  const shape  = $('#shape').value;
  const bgCol  = $('#bgColor').value;
  const bgImg  = $('#bgImage').value.trim();
  const bOn    = $('#borderOn').checked;
  const bCol   = $('#borderColor').value;
  const bW     = Math.max(0, parseInt($('#borderWidth').value||'0',10));
  const shOn   = $('#shadowOn').checked;
  const glOn   = $('#glowOn').checked;
  const glCol  = $('#glowColor').value;
  const alpha  = Math.max(0, Math.min(1, parseFloat($('#alpha').value||'1')));
  const pad    = Math.max(0, parseInt($('#padding').value||'22',10));
  const eff3d  = $('#effect3d').checked;

  // —Ñ–æ—Ä–º–∞
  item.style.borderRadius = (shape==='–ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫') ? '6px'
                          : (shape==='–°–∫—Ä—É–≥–ª—ë–Ω–Ω—ã–π')   ? '16px'
                          : '999px'; // –∫—Ä—É–≥

  // —Ñ–æ–Ω (–∫–∞—Ä—Ç–∏–Ω–∫–∞ –∏–º–µ–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
  if(bgImg){
    item.style.backgroundImage    = `url("${bgImg}")`;
    item.style.backgroundRepeat   = 'no-repeat';
    item.style.backgroundPosition = 'center';
    item.style.backgroundSize     = 'cover';
    item.style.backgroundColor    = 'transparent';
  }else{
    item.style.backgroundImage = 'none';
    item.style.backgroundColor = hexToRGBA(bgCol, 1);
  }

  // —Ä–∞–º–∫–∞
  item.style.border = bOn ? `${bW}px solid ${bCol}` : '0 solid transparent';

  // —Ç–µ–Ω–∏/–ø–æ–¥—Å–≤–µ—Ç–∫–∞
  const baseShadow = shOn ? '0 10px 30px rgba(0,0,0,.5)' : 'none';
  const glowShadow = glOn ? `, 0 0 18px ${hexToRGBA(glCol, .7)}` : '';
  item.style.boxShadow = baseShadow + (glOn ? glowShadow : '');

  // –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å (–Ω–∞ –≤–µ—Å—å —ç–ª–µ–º–µ–Ω—Ç)
  item.style.opacity = String(alpha);

  // –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ—Ç—Å—Ç—É–ø—ã
  item.style.padding = pad + 'px';

  // ¬´3D-—ç—Ñ—Ñ–µ–∫—Ç¬ª ‚Äî –ª—ë–≥–∫–∞—è –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞/–∫–æ–Ω—Ç—É—Ä
  if(eff3d){
    item.style.transform = 'translateZ(0) perspective(600px) rotateX(1.2deg)';
    item.style.outline   = '1px solid rgba(255,255,255,.06)';
  }else{
    item.style.transform = 'none';
    item.style.outline   = 'none';
  }
}
    ['font','fontSize','textColor','previewValue',
 'shape','bgColor','bgImage','borderOn','borderColor','borderWidth',
 'shadowOn','glowOn','glowColor','alpha','padding','effect3d'
].forEach(id=>{
  const el = $('#'+id);
  if(!el) return;
  el.addEventListener('input',  updatePreview);
  el.addEventListener('change', updatePreview);
});
    $('#btnText').addEventListener('click', e=>{e.preventDefault(); $('#previewItem').dataset.mode='text'; updatePreview();});
    $('#btnImage').addEventListener('click', e=>{e.preventDefault(); $('#previewItem').dataset.mode='image'; updatePreview();});
    updatePreview();

    // –í–æ–ø—Ä–æ—Å—ã
    function qTemplate(idx){
      const wrap=document.createElement('div'); wrap.className='level';
      wrap.innerHTML=`
        <h3>–í–æ–ø—Ä–æ—Å <span class="num">${idx+1}</span>
          <span class="right">
            <button type="button" class="btn-ghost up">‚ñ≤</button>
            <button type="button" class="btn-ghost down">‚ñº</button>
            <button type="button" class="btn-danger del">–£–¥–∞–ª–∏—Ç—å</button>
          </span>
        </h3>
        <label>–¢–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞ (–≤–≤–µ—Ä—Ö—É)</label>
        <input type="text" class="question" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –°—Ç–æ–ª–∏—Ü–∞ –§—Ä–∞–Ω—Ü–∏–∏?">
        <div class="row">
          <div>
            <label>–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç (—Ç–µ–∫—Å—Ç –∏–ª–∏ URL)</label>
            <input type="text" class="correct" placeholder="–ü–∞—Ä–∏–∂ –∏–ª–∏ https://.../cat.gif">
          </div>
          <div>
            <label>–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ (–ø–æ –æ–¥–Ω–æ–º—É –≤ —Å—Ç—Ä–æ–∫–µ)</label>
            <textarea class="wrong" placeholder="–ú–∞—Ä—Å–µ–ª—å\n–õ–∏–æ–Ω\n–ù–∏—Ü—Ü–∞"></textarea>
          </div>
        </div>`;
      wrap.querySelector('.del').onclick=()=>{wrap.remove();renumber();};
      wrap.querySelector('.up').onclick=()=>{const p=wrap.previousElementSibling;if(p){wrap.parentNode.insertBefore(wrap,p);renumber();}};
      wrap.querySelector('.down').onclick=()=>{const n=wrap.nextElementSibling;if(n){wrap.parentNode.insertBefore(n,wrap);renumber();}};
      return wrap;
    }
    function addQ(){ const idx=$$('#levels .level').length; $('#levels').appendChild(qTemplate(idx)); renumber(); }
    function renumber(){ $$('#levels .level .num').forEach((n,i)=>n.textContent=i+1); }

    // –°–±–æ—Ä ‚Üí JSON
    function collect(){
      const questions=[];
      $$('#levels .level').forEach(div=>{
        questions.push({
          question: div.querySelector('.question').value.trim(),
          correct:  div.querySelector('.correct').value.trim(),
          wrong:    div.querySelector('.wrong').value.split('\n').map(s=>s.trim()).filter(Boolean)
        });
      });
      return {
  language: $('#language').value,
  font: $('#font').value,
  fontSize: Math.max(10, parseInt($('#fontSize').value||'24',10)),
  textColor: $('#textColor').value,
  speed: Math.max(1, Math.min(10, parseInt($('#speed').value||'5',10))),
  cursor: $('#cursorUrl').value.trim(),

  // –Ω–æ–≤–∞—è –≥—Ä—É–ø–ø–∞ —Å—Ç–∏–ª–µ–π
  style: {
    shape: $('#shape').value,                     // –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫ / –°–∫—Ä—É–≥–ª—ë–Ω–Ω—ã–π / –ö—Ä—É–≥
    bgColor: $('#bgColor').value,                 // #RRGGBB
    bgImage: $('#bgImage').value.trim(),          // URL (–æ–ø—Ü.)
    borderEnabled: $('#borderOn').checked,
    borderColor: $('#borderColor').value,
    borderWidth: Math.max(0, parseInt($('#borderWidth').value||'0',10)),
    shadow: $('#shadowOn').checked,
    glow: $('#glowOn').checked,
    glowColor: $('#glowColor').value,
    alpha: Math.max(0, Math.min(1, parseFloat($('#alpha').value||'1'))),
    padding: Math.max(0, parseInt($('#padding').value||'22',10)),
    effect3d: $('#effect3d').checked
  },
  direction: $('#direction').value,
  answersPerQuestion: Math.max(2, Math.min(10, parseInt($('#answersPerQuestion').value||'4',10))),
  spawnInterval: Math.max(200, parseInt($('#spawnInterval').value||'900',10)),
  questions
};
 
    }

    function validate(cfg){
      if(!cfg.questions.length) return '–î–æ–±–∞–≤—å—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –≤–æ–ø—Ä–æ—Å.';
      for(const [i,q] of cfg.questions.entries()){
        if(!q.question) return `–í–æ–ø—Ä–æ—Å ${i+1}: –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞.`;
        if(!q.correct)  return `–í–æ–ø—Ä–æ—Å ${i+1}: —É–∫–∞–∂–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç.`;
        if((q.wrong?.length||0) + 1 < 2) return `–í–æ–ø—Ä–æ—Å ${i+1}: –Ω—É–∂–µ–Ω –º–∏–Ω–∏–º—É–º –æ–¥–∏–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π.`;
      }
      return null;
    }

    function makeId(cfg){
      const first=(cfg.questions[0]?.question||'quiz').trim();
      const slug=first.toLowerCase().normalize('NFKD').replace(/[\u0300-\u036f]/g,'').replace(/[^a-z0-9]+/g,'-').replace(/^-+|-+$/g,'').slice(0,40)||'quiz';
      const d=new Date(),p=n=>String(n).padStart(2,'0');
      const stamp=`${d.getFullYear()}${p(d.getMonth()+1)}${p(d.getDate())}-${p(d.getHours())}${p(d.getMinutes())}${p(d.getSeconds())}`;
      return `${slug}-${stamp}`;
    }

    const BASE_MAIN=(location.origin + location.pathname).replace(/[^\/]+$/,'') + 'quiz-main.html';

    async function publish(){
      const cfg=collect();
      const err=validate(cfg); if(err){ alert(err); return; }

      const id=makeId(cfg);
      const jsonStr=JSON.stringify(cfg,null,2);

      // —Å–∫–∞—á–∞—Ç—å JSON
      const blob=new Blob([jsonStr],{type:'application/json'});
      const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download=id+'.json';
      document.body.appendChild(a); a.click(); a.remove();

      // iframe
      const iframe=`<iframe src="${BASE_MAIN}?id=${encodeURIComponent(id)}" width="900" height="640" style="border:0;" allow="autoplay" allowfullscreen></iframe>`;
      $('#iframeOut').value=iframe;

      alert('JSON —Å–æ—Ö—Ä–∞–Ω—ë–Ω. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –≤ /data –≤–∞—à–µ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.');
    }

    function quickTest(){
      const cfg=collect(); const err=validate(cfg); if(err){ alert(err); return; }
      alert('JSON –≤–∞–ª–∏–¥–µ–Ω. –í–æ–ø—Ä–æ—Å–æ–≤: '+cfg.questions.length);
    }
    function copyIframe(){
      const v=$('#iframeOut').value.trim(); if(!v){ alert('–°–Ω–∞—á–∞–ª–∞ –æ–ø—É–±–ª–∏–∫—É–π—Ç–µ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å iframe.'); return; }
      navigator.clipboard.writeText(v);
    }

    $('#addQ').addEventListener('click', e=>{ e.preventDefault(); addQ(); });
    $('#saveBtn').addEventListener('click', publish);
    $('#testBtn').addEventListener('click', quickTest);
    $('#copyBtn').addEventListener('click', copyIframe);

    addQ();
  </script>
</body>
</html>
